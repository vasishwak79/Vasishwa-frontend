<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Login</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

<!-- Navigation Bar -->
<header>
  <h1>Lost & Found</h1>
  <nav>
    <a href="index.html" class="nav-btn">Home</a>
    <a href="login.html" class="nav-btn">Login</a>
  </nav>
</header>

<!-- main login page container -->
<section class="container">
<div class="login-wrapper">
    <!-- page title -->
    <h2 style="color:white">Admin Login</h2>

    <!-- login form card -->
    <form id="loginForm" class="card form login-card" aria-label="Administrator Login Form">

      <label for="username" class="form-label">Username</label>
      <input 
        id="username"
        name="username" 
        type="text" 
        class="input-small"
        placeholder="Enter username" 
        required
      >

      <label for="password" class="form-label">Password</label>
      <input 
        id="password"
        name="password" 
        type="password" 
        class="input-small"
        placeholder="Enter password" 
        required
      >

      <button type="submit" class="btn-primary">Login</button>
    </form>
  </div>
  <!-- errer or success message-->
  <p id="msg" class="feedback"></p>

</section>

<script>
document.getElementById("loginForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const msg = document.getElementById("msg");
  msg.textContent = "";

  const formData = new FormData(e.target);
  const data = Object.fromEntries(formData);

  try {
    const res = await fetch("http://localhost:4000/api/login", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    });

    const result = await res.json();

    if (result.success && result.token) {
      // EXACTLY what admin.js expects
      sessionStorage.setItem("adminToken", result.token);

      // Redirect to admin page
      window.location.href = "admin.html";
    } else {
      msg.textContent = "Invalid username or password.";
    }

  } catch (err) {
    console.error(err);
    msg.textContent = "Server error. Please try again.";
  }
});
</script>


</body>
</html>
